const ogData = [
  {
    "Type": "Running",
    "Start": "2023-07-31 18:42",
    "End": "2023-07-31 18:53",
    "Duration": "00:11:23",
    "Total Energy (kcal)": 165.75,
    "Active Energy (kcal)": 142.61,
    "Max Heart Rate (bpm)": 173,
    "Avg Heart Rate (bpm)": 151.27,
    "Distance (mi)": 1.11,
    "Speed": 5.86,
    "Step Count (count)": 1715,
    "Step Cadence (spm)": 2.51,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-31 18:21",
    "End": "2023-07-31 18:27",
    "Duration": "00:05:50",
    "Total Energy (kcal)": 82.84,
    "Active Energy (kcal)": 70.89,
    "Max Heart Rate (bpm)": 148,
    "Avg Heart Rate (bpm)": 134.03,
    "Distance (mi)": 0.556,
    "Speed": 5.71,
    "Step Count (count)": 880,
    "Step Cadence (spm)": 2.51,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-30 18:30",
    "End": "2023-07-30 18:53",
    "Duration": "00:23:45",
    "Total Energy (kcal)": 349.58,
    "Active Energy (kcal)": 301.59,
    "Max Heart Rate (bpm)": 148,
    "Avg Heart Rate (bpm)": 139,
    "Distance (mi)": 2.3,
    "Speed": 5.82,
    "Step Count (count)": 3663,
    "Step Cadence (spm)": 2.57,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-30 09:17",
    "End": "2023-07-30 09:26",
    "Duration": "00:08:24",
    "Total Energy (kcal)": 169.43,
    "Active Energy (kcal)": 124.26,
    "Max Heart Rate (bpm)": 185,
    "Avg Heart Rate (bpm)": 155.89,
    "Distance (mi)": 0.96,
    "Speed": 6.84,
    "Step Count (count)": 1418,
    "Step Cadence (spm)": 2.81,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-29 17:36",
    "End": "2023-07-29 17:59",
    "Duration": "00:23:21",
    "Total Energy (kcal)": 345.73,
    "Active Energy (kcal)": 298.6,
    "Max Heart Rate (bpm)": 147,
    "Avg Heart Rate (bpm)": 138.29,
    "Distance (mi)": 2.28,
    "Speed": 5.85,
    "Step Count (count)": 3649,
    "Step Cadence (spm)": 2.6,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-29 09:40",
    "End": "2023-07-29 09:49",
    "Duration": "00:09:33",
    "Total Energy (kcal)": 153.71,
    "Active Energy (kcal)": 134.27,
    "Max Heart Rate (bpm)": 184,
    "Avg Heart Rate (bpm)": 162.02,
    "Distance (mi)": 1.02,
    "Speed": 6.42,
    "Step Count (count)": 1471,
    "Step Cadence (spm)": 2.56,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-28 17:31",
    "End": "2023-07-28 17:50",
    "Duration": "00:19:23",
    "Total Energy (kcal)": 309.85,
    "Active Energy (kcal)": 270.72,
    "Max Heart Rate (bpm)": 180,
    "Avg Heart Rate (bpm)": 152.43,
    "Distance (mi)": 2.1,
    "Speed": 6.48,
    "Step Count (count)": 3097,
    "Step Cadence (spm)": 2.66,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-27 18:32",
    "End": "2023-07-27 18:35",
    "Duration": "00:02:35",
    "Total Energy (kcal)": 36.6,
    "Active Energy (kcal)": 31.18,
    "Max Heart Rate (bpm)": 140,
    "Avg Heart Rate (bpm)": 116.43,
    "Distance (mi)": 0.233,
    "Speed": 5.38,
    "Step Count (count)": 355,
    "Step Cadence (spm)": 2.28,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-26 18:38",
    "End": "2023-07-26 18:58",
    "Duration": "00:19:32",
    "Total Energy (kcal)": 307.59,
    "Active Energy (kcal)": 268.11,
    "Max Heart Rate (bpm)": 182,
    "Avg Heart Rate (bpm)": 156.95,
    "Distance (mi)": 2.05,
    "Speed": 6.31,
    "Step Count (count)": 3076,
    "Step Cadence (spm)": 2.62,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-25 18:33",
    "End": "2023-07-25 18:52",
    "Duration": "00:19:17",
    "Total Energy (kcal)": 305.79,
    "Active Energy (kcal)": 266.92,
    "Max Heart Rate (bpm)": 183,
    "Avg Heart Rate (bpm)": 159.56,
    "Distance (mi)": 2.06,
    "Speed": 6.4,
    "Step Count (count)": 3058,
    "Step Cadence (spm)": 2.64,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-24 18:03",
    "End": "2023-07-24 18:11",
    "Duration": "00:08:24",
    "Total Energy (kcal)": 137.65,
    "Active Energy (kcal)": 120.54,
    "Max Heart Rate (bpm)": 188,
    "Avg Heart Rate (bpm)": 167.05,
    "Distance (mi)": 0.942,
    "Speed": 6.72,
    "Step Count (count)": 1375,
    "Step Cadence (spm)": 2.73,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-23 17:55",
    "End": "2023-07-23 18:15",
    "Duration": "00:19:51",
    "Total Energy (kcal)": 312.47,
    "Active Energy (kcal)": 272.39,
    "Max Heart Rate (bpm)": 179,
    "Avg Heart Rate (bpm)": 156.66,
    "Distance (mi)": 2.1,
    "Speed": 6.34,
    "Step Count (count)": 3169,
    "Step Cadence (spm)": 2.66,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-22 18:48",
    "End": "2023-07-22 18:57",
    "Duration": "00:08:12",
    "Total Energy (kcal)": 137.66,
    "Active Energy (kcal)": 120.89,
    "Max Heart Rate (bpm)": 184,
    "Avg Heart Rate (bpm)": 158.38,
    "Distance (mi)": 0.942,
    "Speed": 6.88,
    "Step Count (count)": 1336,
    "Step Cadence (spm)": 2.71,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-21 17:05",
    "End": "2023-07-21 17:14",
    "Duration": "00:08:29",
    "Total Energy (kcal)": 145.31,
    "Active Energy (kcal)": 128.02,
    "Max Heart Rate (bpm)": 184,
    "Avg Heart Rate (bpm)": 154.25,
    "Distance (mi)": 0.983,
    "Speed": 6.95,
    "Step Count (count)": 1368,
    "Step Cadence (spm)": 2.69,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-19 18:19",
    "End": "2023-07-19 18:24",
    "Duration": "00:04:36",
    "Total Energy (kcal)": 68.76,
    "Active Energy (kcal)": 58.61,
    "Max Heart Rate (bpm)": 182,
    "Avg Heart Rate (bpm)": 163.94,
    "Distance (mi)": 0.47,
    "Speed": 6.11,
    "Step Count (count)": 686,
    "Step Cadence (spm)": 2.48,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-17 17:44",
    "End": "2023-07-17 17:53",
    "Duration": "00:08:44",
    "Total Energy (kcal)": 147.02,
    "Active Energy (kcal)": 129.22,
    "Max Heart Rate (bpm)": 186,
    "Avg Heart Rate (bpm)": 163.01,
    "Distance (mi)": 1,
    "Speed": 6.87,
    "Step Count (count)": 1357,
    "Step Cadence (spm)": 2.59,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  },
  {
    "Type": "Running",
    "Start": "2023-07-16 16:31",
    "End": "2023-07-16 16:36",
    "Duration": "00:04:56",
    "Total Energy (kcal)": 73.44,
    "Active Energy (kcal)": 63.2,
    "Max Heart Rate (bpm)": 178,
    "Avg Heart Rate (bpm)": 156.9,
    "Distance (mi)": 0.475,
    "Speed": 5.77,
    "Step Count (count)": 640,
    "Step Cadence (spm)": 2.16,
    "Swimming Stroke Count (count)": "",
    "Swim Stoke Cadence (spm)": "",
    "Flights Climbed (count)": "",
    "Elevation Ascended (ft)": "",
    "Elevation Descended (ft)": ""
  }
];

// Add a new column "ShortDateTime" with parsed datetime in a shorter format
const myData = ogData.map((item) => {
  const parsedDateTime = new Date(item.Start);
  const shortDate = parsedDateTime.toLocaleDateString(); // You can customize the date format here
  return {
    ...item,
    ShortDate: shortDate,
  };
});



myData.sort((a, b) => new Date(a.Start) - new Date(b.Start));

const getAverage = (list, ogList) => {
  // Calculate the count of items for each unique "ShortDate"

  return list.map((obj) => {
    const newObj = { ...obj }; // Create a new object to avoid mutating the original object
    for (const key in newObj) {
      if (typeof newObj[key] === 'number') {
        const filteredData = ogList.filter((obj) => obj.ShortDate === newObj.ShortDate);
        newObj[key] = (newObj[key] / filteredData.length).toFixed(2);
      }
    }
    return newObj;
  });
};

const aggregateData = (aggregationType) => {
  // Group the data by "ShortDate" and calculate the totals for each group
  const aggregatedData = myData.reduce((result, item) => {
    const { ShortDate, ...otherFields } = item;
    if (!result[ShortDate]) {
      // Initialize the group with 'Total' appended to all other fields
      result[ShortDate] = {
        ShortDate,
        ...Object.keys(otherFields).reduce((acc, field) => {
          acc[field] = otherFields[field];
          return acc;
        }, {}),
      };
    } else {
      // If the group already exists, update the totals for each field
      for (const field in otherFields) {
        if (typeof otherFields[field] === 'number') {
          result[ShortDate][field] = Math.round(100 * ((result[ShortDate][field] || 0) + otherFields[field])) / 100;
        }
      }
    }
    return result;
  }, {});

  // Convert the aggregatedData object to an array of objects
  const aggregatedDataArray = Object.values(aggregatedData);
  if (aggregationType === 'Average') {
    return getAverage(aggregatedDataArray, myData);
  }
  return aggregatedDataArray;
};


export { myData, aggregateData }